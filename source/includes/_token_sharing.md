# Token Sharing

## Acquisition via API

> Request

```shell
curl-X POST \
  {{url}}/apps/token \
  -H "Content-type: application/json"  \
  -H 'Authorization: YOUR_TOKEN' \
  -d '{
    "x_partner_token": "3c62880548592b9366a186df2253e993da9cc",
    "amount_sanctioned": "100000",
    "final_approval": true,
    "loan_duration_type": "days",
    "interest_frequency": "yearly",
    "interest_type": "reducing",
    "interest": "18",
    "duration": "360"
    "verified_customer_ref_id": "ABCD1234512222"
  }'
```

> Response

```json
{
  "status": "1",
  "msg": ""
}
```

Refer the [acquisition via API](#acquisition) section.

`POST {{url}}/application/token`

<aside class="notice">
If <code>final_approval</code> is True then the case has been disbursed and <code>x_partner_token</code> will contain the token in this case
</aside>
<aside class="notice">
If <code>final_approval</code> is False then the case has been rejected
</aside>

## Acquisition via FS App

The following is a generic format with which we can share the Token. We have a handshake id generated by us. This will be used in the communication till we get the <code>verified_customer_reference_id</code> from your system. Once confirmed we will use the
<code>verified_customer_reference_id</code> to send the token.

### Handshake

> Request:

```shell
curl-X POST \
  {{url}}/handshake/token \
  -H 'Content-type: application/json'  \
  -H 'Authorization: YOUR_TOKEN' \
  -d '{
    "handshake_id": "4b816c58-2bd3-46cb-aefa-d431dd03608a",
    "captured_customer_ref_id": "ABCD1234512222",
    "customer_attrs": {
      "email": "a@B.com",
      "phone": "1234543212",
      "customer_name": "test name",
      "business_name": "test biz",
      "resi_address": "test resi add",
      "resi_pincode": "1111",
      "resi_city": "bangalore",
      "biz_address": "asasassa",
      "biz_pincode": "123456",
      "biz_city": "bangalore"
    },
    "async_result_callback_url":"CF_URL_where_partner_will_post_the_response_incase_it_cant_give_response_in_sync",
    "token_callback_url":"Optional now. Dynamic url for sending token per user case. You can send this as harcoded one Will be used in future"
  }'
```

> Response:

```json
{
  "status": "1",
  "captured_customer_ref_id": "ABCD1234512222",
  "verified_customer_ref_id": "ABCD1234512222",
  "handshake_id": "4b816c58-2bd3-46cb-aefa-d431dd03608a",
  "msg": "",
  "customer_data": {
    "email": "a@BC.com",
    "phone": "1234543212",
    "customer_name": "test name verified",
    "business_name": "test biz verified",
    "resi_address": "test resi add verified",
    "resi_pincode": "1111",
    "resi_city": "",
    "biz_address": "",
    "biz_address": "asasassa",
    "biz_city": ""
  }
}
```

Handshake initiation & Confirmation (The customer reference search API)

`POST {{url}}/handshake/token`

**Notes:**

* Status codes

  * < 0 → Is an error
  * 1 → Is reponse is giving in sync i.e instantaneously
  * 2 → Response will be posted to `async_result_callback_url`

* `verified_customer_ref_id` is the verified id and sent by partners . It will be used for further communication.

## Token Status

Coming Soon
